name: docker build
on: push

jobs:
    build:
        runs-on: ubuntu-22.04
        strategy:
            fail-fast: false
            matrix:
                include:
                    - image: debian:testing
                    #- image: debian:stable ## TODO

        container:
            image: ${{ matrix.image }}

        steps:
            - uses: actions/checkout@v3
            - name: System Basic Packages
              run: |
                  apt-get update
                  apt-get install --yes --no-install-recommends adduser ## shellcheck sudo wget ca-certificates wixl fpc lazarus git
            - name: System information
              run: |
                  cat /etc/os-release
                  uname -a
                  echo "${PATH}"
            - name: Normal user with sudo privileges
              run: |
                  whoami
                  adduser --gecos "" --disabled-password user
            - name: User home folder
              run: |
                  mkdir --parents /home/user
                  chown --recursive user:user /home/user
            #- name: ppcross_install
              #run: ./ppcross_install all
            - name: Run Installer
              run: su -s /bin/bash user -- ./build-dummy.sh
            #- name: Run Installer ShellCheck
              #run: shellcheck ./*.sh

# vim: sw=4
